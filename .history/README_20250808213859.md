# Data Platform Architecture

## Overview

This document outlines the comprehensive data platform architecture I've designed and implemented to support our organization's data governance, pipeline automation, storage, visualization, and client access requirements. The system is built with modern cloud-native technologies and follows best practices for data engineering and security.

## Architecture Layers

### 1. Governance & Monitoring Layer

The top-level governance layer provides centralized control and management of the entire data platform using Open Metadata. This layer ensures data quality, compliance, and operational oversight across all system components.

**Key Components:**
- **Open Metadata**: Central metadata management and governance
- **Apache Atlas**: Data lineage and governance tracking
- **Prometheus & Grafana**: System monitoring and alerting

### 2. Pipeline & Operation Layer

This layer handles automated data pipeline operations, including Extract-Transform-Load (ETL) processes from various data sources including IoT devices and applications, with data flowing to the data warehouse.

**Key Components:**
- **Apache Airflow**: Primary workflow orchestration engine
- **Windmill**: Alternative workflow automation tool
- **GitLab**: Version control and CI/CD pipeline management

### 3. Data Sources & Ingestion Layer

This layer handles data collection and ingestion from various sources including IoT devices, web scraping, and external applications.

**Key Components:**
- **Web Scraping Engine**: Converts websites into LLM-ready data
- **IoT Data Collectors**: Real-time data collection from IoT devices
- **API Integrations**: External data source connections
- **Data Validation**: Quality checks and data validation

### 4. Database & Storage Layer

The storage layer manages both structured and unstructured data with specialized components for different data types.

**Key Components:**
- **MySQL**: Primary relational database for structured data
- **MinIO**: Object storage for unstructured data and files
- **InfluxDB**: Time-series database for IoT and sensor data
- **MongoDB**: Document database for flexible schema data

### 5. Data Processing & Analytics Layer

This layer provides data processing, transformation, and analytics capabilities.

**Key Components:**
- **Microsoft Fabric**: Comprehensive data platform including:
  - Data Factory for ETL orchestration
  - Data Warehouse for analytical processing
  - Data Engineering for transformation logic
  - Real-Time Analytics for streaming data
  - Power BI for interactive dashboards
- **Apache Spark**: Big data processing and analytics
- **Data Quality Tools**: Data validation and cleansing

### 6. Visualization & Reporting Layer

This layer provides data visualization and business intelligence capabilities.

**Key Components:**
- **Power BI**: Interactive dashboards and reports
- **Google Analytics**: Web traffic analysis and user behavior
- **Smartlook**: User session recording and heatmaps
- **Custom Dashboards**: Real-time monitoring dashboards

### 7. IoT & Edge Computing Layer

This layer encompasses various IoT applications and edge computing services that generate and process data at the edge.

**Key Components:**
- **Smart City Applications**: Smart Parking, Smart Waste, Smart Pole
- **Smart Agriculture**: Smart Farm monitoring and automation
- **Smart Building**: Smart Home and Smart Office systems
- **Healthcare IoT**: Exoskeleton and medical device monitoring
- **Edge Computing**: Local data processing and analytics
- **People Counting**: Traffic and occupancy analytics

### 8. Development & Operations Layer

Development and deployment tools that support the platform's operational needs.

**Key Components:**
- **Portainer.io**: Container management for production and development environments
- **Streamlit**: Web application framework for data applications
- **GitLab CI/CD**: Automated deployment and testing
- **Monitoring Tools**: Application performance monitoring

### 9. Security & Access Management Layer

Security and access management layer that handles both internal and external access with proper authentication and authorization.

**Key Components:**
- **Kong API Gateway**: API management, routing, and rate limiting
- **Azure AD**: Identity and access management with SSO
- **Client Access**: Secure GUI access for authorized users
- **Network Security**: Firewall and intrusion detection

### 10. Web Presence & Analytics Layer

Web presence management with traffic tracking and tag management capabilities.

**Key Components:**
- **Google Tag Manager**: Tag management for static websites
- **Static Websites**: Various organizational websites (nccthailand, qsncc, EO website)
- **Web Analytics**: Traffic monitoring and user behavior analysis

## Data Flow Architecture

```mermaid
graph TB
    subgraph "Governance & Monitoring"
        OM[Open Metadata]
        AA[Apache Atlas]
        PG[Prometheus & Grafana]
    end

    subgraph "Pipeline & Operation"
        AIR[Apache Airflow]
        WM[Windmill]
        GL[GitLab]
    end

    subgraph "Data Sources & Ingestion"
        WSE[Web Scraping Engine]
        IOT[IoT Data Collectors]
        API[API Integrations]
    end

    subgraph "Database & Storage"
        MYSQL[MySQL]
        MINIO[MinIO]
        INFLUX[InfluxDB]
        MONGO[MongoDB]
    end

    subgraph "Data Processing & Analytics"
        MF[Microsoft Fabric]
        SPARK[Apache Spark]
        DQ[Data Quality Tools]
    end

    subgraph "Visualization & Reporting"
        PBI[Power BI]
        GA[Google Analytics]
        SL[Smartlook]
    end

    subgraph "IoT & Edge Computing"
        SC[Smart City Apps]
        SA[Smart Agriculture]
        SB[Smart Building]
        HC[Healthcare IoT]
    end

    subgraph "Development & Operations"
        PORT[Portainer.io]
        ST[Streamlit]
        MON[Monitoring Tools]
    end

    subgraph "Security & Access"
        KONG[Kong API Gateway]
        AAD[Azure AD]
        NS[Network Security]
    end

    subgraph "Web Presence & Analytics"
        GTM[Google Tag Manager]
        SW[Static Websites]
        WA[Web Analytics]
    end

    %% Governance connections
    OM -.->|Metadata Governance| AIR
    OM -.->|Metadata Governance| MF
    PG -->|Monitoring| AIR
    PG -->|Monitoring| MF

    %% Pipeline connections
    AIR -->|ETL Orchestration| WSE
    AIR -->|ETL Orchestration| IOT
    WM -->|Data Processing| API
    GL -->|CI/CD| PORT

    %% Data Ingestion connections
    WSE -->|Raw Data| MYSQL
    WSE -->|Files| MINIO
    IOT -->|Time Series| INFLUX
    API -->|Structured Data| MYSQL
    API -->|Documents| MONGO

    %% Processing connections
    MYSQL -->|Structured Data| MF
    MINIO -->|Files| MF
    INFLUX -->|Time Series| MF
    MONGO -->|Documents| MF
    MF -->|Processed Data| SPARK
    SPARK -->|Analytics| DQ

    %% Visualization connections
    MF -->|Reports| PBI
    DQ -->|Clean Data| PBI
    SW -->|Traffic Data| GA
    SW -->|User Behavior| SL

    %% IoT connections
    SC -->|Sensor Data| IOT
    SA -->|Farm Data| IOT
    SB -->|Building Data| IOT
    HC -->|Health Data| IOT

    %% Security connections
    PBI -->|Secure Access| KONG
    PORT -->|API Access| KONG
    AAD -->|Authentication| KONG

    %% Web connections
    SW -->|Content| WSE
    SW -->|Analytics| GA
    SW -->|Tracking| SL

    %% Styling with better contrast
    classDef governance fill:#E8F5E8,stroke:#2E7D32,stroke-width:2px,color:#1B5E20
    classDef pipeline fill:#FFE6F2,stroke:#C2185B,stroke-width:2px,color:#880E4F
    classDef ingestion fill:#FFF3E0,stroke:#F57C00,stroke-width:2px,color:#E65100
    classDef storage fill:#E3F2FD,stroke:#1976D2,stroke-width:2px,color:#0D47A1
    classDef processing fill:#F3E5F5,stroke:#7B1FA2,stroke-width:2px,color:#4A148C
    classDef visualization fill:#E8F5E8,stroke:#388E3C,stroke-width:2px,color:#1B5E20
    classDef iot fill:#FFF8E1,stroke:#FBC02D,stroke-width:2px,color:#F57F17
    classDef devops fill:#FCE4EC,stroke:#C2185B,stroke-width:2px,color:#880E4F
    classDef security fill:#FFEBEE,stroke:#D32F2F,stroke-width:2px,color:#B71C1C
    classDef web fill:#E0F2F1,stroke:#00695C,stroke-width:2px,color:#004D40

    class OM,AA,PG governance
    class AIR,WM,GL pipeline
    class WSE,IOT,API ingestion
    class MYSQL,MINIO,INFLUX,MONGO storage
    class MF,SPARK,DQ processing
    class PBI,GA,SL visualization
    class SC,SA,SB,HC iot
    class PORT,ST,MON devops
    class KONG,AAD,NS security
    class GTM,SW,WA web
```

## Security Architecture

The platform implements a multi-layered security approach:

1. **API Gateway Security**: Kong API Gateway manages all external access
2. **Identity Management**: Azure AD provides centralized authentication
3. **Data Governance**: Open Metadata ensures data lineage and compliance
4. **Access Control**: Role-based access control for different user types
5. **Secure Routes**: All client access goes through proper authentication channels

## Data Flow Patterns

- **Green Dashed Lines**: Secure client access via GUI with best practices
- **Purple Dashed Lines**: Server-to-server integration
- **Dark Purple Dashed Lines**: Metadata governance connections
- **Red Dashed Lines**: Direct access routes (not recommended)
- **Black Dashed Lines**: Planning and coordination flows
- **Black Double-Headed Lines**: Two-way communication

## Technology Stack

### Governance & Monitoring
- Open Metadata (Central metadata management)
- Apache Atlas (Data lineage and governance)
- Prometheus & Grafana (System monitoring)

### Pipeline & Orchestration
- Apache Airflow (Primary workflow orchestration)
- Windmill (Alternative automation)
- GitLab (Version control and CI/CD)

### Data Sources & Ingestion
- Web Scraping Engine (LLM-ready data conversion)
- IoT Data Collectors (Real-time sensor data)
- API Integrations (External data sources)

### Storage & Databases
- MySQL (Primary relational database)
- InfluxDB (Time-series database for IoT)
- MinIO (Object storage for files)
- MongoDB (Document database)

### Data Processing & Analytics
- Microsoft Fabric (Data Factory, Warehouse, Engineering)
- Apache Spark (Big data processing)
- Data Quality Tools (Validation and cleansing)

### Visualization & Reporting
- Power BI (Interactive dashboards)
- Google Analytics (Web traffic analysis)
- Smartlook (User behavior tracking)

### IoT & Edge Computing
- Smart City Applications (Parking, Waste, Poles)
- Smart Agriculture (Farm monitoring)
- Smart Building (Home and Office automation)
- Healthcare IoT (Medical devices)

### Development & Operations
- Portainer.io (Container management)
- Streamlit (Data applications)
- GitLab CI/CD (Automated deployment)

### Security & Access
- Kong API Gateway (API management)
- Azure AD (Identity and access management)
- Network Security (Firewall and intrusion detection)

### Web Presence & Analytics
- Google Tag Manager (Tag management)
- Static Websites (Organizational websites)
- Web Analytics (Traffic monitoring)

## Implementation Notes

This architecture was designed to handle the complexity of modern data operations while maintaining security, scalability, and operational efficiency. The system supports both real-time and batch processing requirements, with proper governance and monitoring throughout the data lifecycle.

The platform is built to accommodate future growth and technology evolution, with modular components that can be independently scaled and updated as needed.
